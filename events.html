<!DOCTYPE html>
<html lang="en">
<head>
    <title>Cultural Events</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        @font-face {
            font-family: 'BaseNeueTrial';
            src: url('./fonts/BaseNeueTrial-Regular.ttf') format('truetype');
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }

        /* Prevent background scroll when modal is open */
        body.overflow-hidden {
            overflow: hidden;
        }

        .back-to-top { transition: opacity .3s ease; }
        .back-to-top.visible { opacity: 1 !important; pointer-events: auto; }
        
        .hiding { display: none; }
        .show { display: block; }
        #menu-overlay {
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease-in-out, visibility 0.4s ease-in-out;
        }
        #hero-logo {
            width: 150px;
            height: 84px;
            scale: 1.5;
            cursor: pointer;
        }

        #menu-overlay.is-open {
            opacity: 1;
            visibility: visible;
        }


        .hamburger-icon, .x-icon {
            transition: transform 0.3s ease-in-out, opacity 0.2s ease-in-out;
            transform-origin: center;
        }

        .x-icon {
            opacity: 0;
            transform: scale(0.6) rotate(-45deg);
        }

        #menu-toggle.is-active .hamburger-icon {
            opacity: 0;
            transform: scale(0.6) rotate(45deg);
        }

        #menu-toggle.is-active .x-icon {
            opacity: 1;
            transform: scale(1) rotate(0);
        }
        
        /* --- Menu Item Styles --- */
        .menu-item {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease-in-out;
            border-radius: 8px;
            height: 120px;
            background-color: #f3f4f6;
            color: #1f2937;
            font-weight: bold;
            font-size: 1.25rem;
            overflow: hidden; /* Important for the image and clip-path */
            border: 3px solid white;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .menu-item:hover {
            transform: scale(1.05) rotate(0deg) !important; /* Override inline rotate on hover */
            z-index: 10;
        }

        .menu-item img {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; /* Use 'cover' for better image scaling */
            z-index: 0;
        }

        .menu-item span {
            position: relative;
            z-index: 10;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
        }
        
        /* Clip-path shapes for the torn paper effect */
        #home { clip-path: polygon(0% 15%, 15% 15%, 15% 0%, 85% 0%, 85% 15%, 100% 15%, 100% 85%, 85% 85%, 85% 100%, 15% 100%, 15% 85%, 0% 85%); }
        #registration { clip-path: polygon(0 20%, 100% 0, 100% 80%, 0 100%); }
        #events { clip-path: polygon(20% 0%, 80% 0%, 100% 100%, 0% 100%); }
        #teams { clip-path: polygon(0 0, 100% 20%, 100% 100%, 0 80%); }
        #profile { clip-path: polygon(25% 0%, 100% 0%, 75% 100%, 0% 100%); }
        #workshops { clip-path: polygon(0 0, 100% 0, 85% 100%, 15% 100%); }
        #contact { clip-path: polygon(0 0, 80% 0, 100% 100%, 20% 100%); }
        #sponsorsmenu { clip-path: polygon(20% 0, 100% 0, 80% 100%, 0 100%); }
        #about { clip-path: polygon(0 0, 100% 0, 100% 75%, 75% 75%, 75% 100%, 50% 75%, 0% 75%); }
        #schedule { clip-path: polygon(0 0, 100% 0, 100% 85%, 85% 100%, 0 100%); }

        #header {
            height: 104px;
            
            justify-items: center;
            align-items: center;
            
        }

        /* Card Animation Styles */
        .member-card {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            animation: cardFadeIn 0.8s ease-out forwards;
        }

        .member-card:nth-child(1) { animation-delay: 0.1s; }
        .member-card:nth-child(2) { animation-delay: 0.2s; }
        .member-card:nth-child(3) { animation-delay: 0.3s; }
        .member-card:nth-child(4) { animation-delay: 0.4s; }
        .member-card:nth-child(5) { animation-delay: 0.5s; }
        .member-card:nth-child(6) { animation-delay: 0.6s; }
        .member-card:nth-child(7) { animation-delay: 0.7s; }
        .member-card:nth-child(8) { animation-delay: 0.8s; }

        @keyframes cardFadeIn {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.9);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .member-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .member-card img {
            transition: transform 0.3s ease;
        }

        .member-card:hover img {
            transform: scale(1.05);
        }

        .member-card h4 {
            transition: color 0.3s ease;
        }

        .member-card:hover h4 {
            color: #059669;
        }

        /* Filter button animations */
        .filter-btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .filter-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .filter-btn:hover::before {
            left: 100%;
        }

        .filter-btn:active {
            transform: scale(0.95);
        }

        /* Section animations */
        .committee-section {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease-out;
        }

        .committee-section.show {
            opacity: 1;
            transform: translateY(0);
            animation: sectionSlideIn 0.6s ease-out;
        }

        @keyframes sectionSlideIn {
            0% {
                opacity: 0;
                transform: translateY(30px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Modal animations (lightweight) */
        #eventModal {
            opacity: 0;
            visibility: hidden;
            transition: opacity 180ms ease, visibility 180ms ease;
            will-change: opacity, visibility;
        }

        /* Backdrop visible state */
        #eventModal.is-open {
            opacity: 1;
            visibility: visible;
        }

        /* Modal content: subtle translate + fade (no scaling) */
        #modalContent {
            transform: translateY(8px);
            opacity: 0;
            transition: transform 180ms cubic-bezier(0.2, 0, 0.2, 1), opacity 160ms ease;
            will-change: transform, opacity;
        }

        #eventModal.is-open #modalContent {
            transform: translateY(0);
            opacity: 1;
        }

        /* Respect users who prefer reduced motion */
        @media (prefers-reduced-motion: reduce) {
            #eventModal,
            #modalContent {
                transition: none !important;
            }
        }

        /* Loading animation for event cards */
        .loading-skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>
</head>
<body>

    <header id="header" class="fixed top-0 left-0 right-0 w-full bg-white/40 backdrop-blur-md shadow z-10" style="height: 84px;">
        
    </header>
    
    <div class="relative flex flex-col items-center justify-center">

        <!-- <img src="./asserts/backgrounds/varnave bg web-01.png" alt="Logo Cover" class="absolute inset-0 w-full h-full object-cover z-0 pointer-events-none"> -->

        <div class="absolute top-0 left-0 w-full flex items-center justify-between px-8 z-20">

            <div id="menu-overlay" class="fixed inset-0 flex flex-col p-8 bg-white/45 backdrop-blur-sm overflow-y-auto">
                <!-- Menu Header -->
                <div class="w-full max-w-6xl mx-auto flex flex-col items-center mb-12 gap-10 flex-shrink-0">
                    <div class="text-2xl font-bold text-gray-800" style="width: 400px; height: auto; object-fit: contain;">
                        <img src="asserts/logos/with outline wen-02.png" alt="" style="width: 400px;">
                    </div>
                </div>
                <div class="w-full max-w-6xl mx-auto flex flex-col items-left mb-12 gap-10 flex-shrink-0">
                    <div class="text-2xl font-bold text-gray-800" style="width: 400px; object-fit: contain;">
                        Menu
                    </div>
                </div>

                <!-- Navigation Grid (inside overlay) -->
                <div class="w-full max-w-6xl mx-auto flex-grow flex items-center">
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 md:gap-6 w-full">
                        <a href="./index.html" id="home" class="menu-item col-span-1 md:row-span-2 flex items-center justify-center text-4xl h-48 md:h-auto" style="transform: rotate(-5deg);">
                            <img src="https://placehold.co/400x600/333/fff?text=Home" alt="Home">
                        </a>
                        <a href="./register.html" id="registration" class="menu-item col-span-1 flex items-center justify-center text-2xl h-32" style="transform: rotate(3deg);">
                            <img src="https://placehold.co/600x400/444/fff?text=Registration" alt="Registration">
                        </a>
                        <a href="./events.html" id="events" class="menu-item col-span-1 flex items-center justify-center text-3xl h-32" style="transform: rotate(-2deg);">
                            <img src="https://placehold.co/600x400/555/fff?text=Events" class="opacity-50" alt="Events">
                            <span class="relative z-10">EVENTS</span>
                        </a>
                        <a href="./team.html" id="teams" class="menu-item col-span-1 flex items-center justify-center text-3xl h-32" style="transform: rotate(4deg);">
                            <img src="https://placehold.co/600x400/666/fff?text=Teams" class="opacity-50" alt="Teams">
                            <span class="relative z-10">TEAMS</span>
                        </a>
                        
                        <a href="./contact.html" id="contact" class="menu-item col-span-1 md:row-span-2 flex items-center justify-center text-3xl h-48 md:h-auto" style="transform: rotate(5deg);">
                            <img src="https://placehold.co/400x600/888/fff?text=Contact" class="opacity-50" alt="Contact">
                            <span class="relative z-10">CONTACT</span>
                        </a>
                        <a href="./sponsors.html" id="sponsorsmenu" class="menu-item col-span-1 flex items-center justify-center text-3xl h-32" style="transform: rotate(-4deg);">
                            <img src="https://placehold.co/600x400/999/fff?text=Sponsors" class="opacity-50" alt="Sponsors">
                            <span class="relative z-10">SPONSORS</span>
                        </a>
                        
                        <a href="./schedule.html" id="schedule" class="menu-item col-span-1 md:col-span-2 lg:col-span-1 flex items-center justify-center text-3xl h-32" style="transform: rotate(-3deg);">
                            <img src="https://placehold.co/600x400/bbb/fff?text=Schedule" class="opacity-50" alt="Schedule">
                            <span class="relative z-10">SCHEDULE</span>
                        </a>
                    </div>
                </div>
            </div>

            <button id="menu-toggle" style="position: fixed; top: 25px; right: 2rem; z-index: 30;" class="flex items-center justify-center z-50 h-12 w-12 rounded-full bg-white shadow-lg hover:bg-gray-100 transition  ">
                <svg class="h-6 w-6 text-gray-800" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path class="hamburger-icon" stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
                    <path class="x-icon" stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>

            
        </div>
        <div class="fixed flex items-center justify-center" style="width: 100%; height: fit-content; top: 0rem; z-index: 11;">
            <img src="./asserts/logos/with outline wen-02.png" alt="Logo" id="hero-logo" onclick="window.location.href='./index.html'" class="relative z-50 object-contain">
            <!-- <div class="absolute w-48 h-48 rounded-full bg-blue-400 opacity-30 blur-2xl animate-pulse"></div> -->
        </div>
    </div>

    <div id="page-info-events" class="relative pt-52 pb-16 flex flex-col items-center justify-center text-center">
        <img src="./asserts/backgrounds/varnave bg web-01.png" alt="Abstract background" style="z-index: -1;" class="fixed inset-0 w-full h-full object-cover pointer-events-none">
        
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900">Cultural Events</h1>
        <p class="mt-4 text-gray-700 max-w-2xl px-4">Discover the exciting lineup of performances and activities at our cultural fest.</p>
    </div>

    <div class="container mx-auto px-4 md:px-6 lg:px-8 py-12">

        <div class="filter-buttons text-center mb-10 bg-white/70 backdrop-blur rounded-2xl shadow p-6">
            <button id="alleventbut" class="filter-btn inline-flex items-center rounded-full bg-emerald-50 text-emerald-800 px-4 py-2 font-semibold hover:bg-emerald-500 hover:text-white transition active:bg-emerald-600" data-filter="all">All</button>
            <button id="onstagebut" class="filter-btn inline-flex items-center rounded-full bg-emerald-50 text-emerald-800 px-4 py-2 font-semibold hover:bg-emerald-500 hover:text-white transition" data-filter="eventplaceholder1">On-Stage</button>
            <button id="offstagebut" class="filter-btn inline-flex items-center rounded-full bg-emerald-50 text-emerald-800 px-4 py-2 font-semibold hover:bg-emerald-500 hover:text-white transition" data-filter="eventplaceholder2">Off-Stage</button>
        </div>

        <div class="space-y-16 bg-white/70 backdrop-blur rounded-2xl shadow p-10">
            <section id="allevents" class="committee-section hiding">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8" id="allMembers">
                    </div>
            </section>

            <section id="eventplaceholder1" class="committee-section">
                <div class="text-center mb-8">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-900 inline-block pb-2 border-b-4 border-emerald-400">On-Stage Events</h2>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8" id="onStageMembers">
                    </div>
            </section>

            <section id="eventplaceholder2" class="committee-section">
                 <div class="text-center mb-8">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-900 inline-block pb-2 border-b-4 border-emerald-400">Off-Stage Events</h2>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8" id="offStageMembers">
                    </div>
            </section>
        </div>
    </div>

    <div id="eventModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[1000]" onclick="hideModal()">
        <div id="modalContent" class="bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto p-8 relative" onclick="event.stopPropagation()">
            <button onclick="hideModal()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800">
                <svg class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>
            </button>
            <h2 id="modalTitle" class="text-3xl font-bold text-gray-900 mb-4">Event Title</h2>
            <div class="space-y-2 text-gray-600 mb-6">
                <p><strong class="font-semibold text-gray-800">Date & Time:</strong> <span id="modalDateTime"></span></p>
                <p><strong class="font-semibold text-gray-800">Venue:</strong> <span id="modalVenue"></span></p>
                <p><strong class="font-semibold text-gray-800">Prize:</strong> <span id="modalPrize"></span></p>
                <p><strong class="font-semibold text-gray-800">Participants:</strong> <span id="modalParticipants"></span></p>
            </div>
            <p id="modalFullDesc" class="text-gray-700 mb-6 whitespace-pre-wrap">Full event description goes here...</p>
            
            <h3 class="text-xl font-bold text-gray-800 mb-3">Rules</h3>
            <ul id="modalRules" class="list-disc list-inside space-y-2 text-gray-700">
                </ul>
        </div>
    </div>

    <footer id="site-footer" class="bg-gray-900 text-gray-300 relative overflow-hidden" style="height: fit-content;">
        <img src="./asserts/backgrounds/footer-01.png" alt="Footer background" class="absolute inset-0 h-full w-full object-cover opacity-60 z-0" style="object-fit: cover;">

        <div class="relative z-10 max-w-7xl mx-auto px-6 lg:px-8 py-16">

            <div id="links" class="flex flex-col lg:flex-row justify-between gap-12 lg:gap-24 t-10">

                <div class="flex flex-col gap-12 text-center sm:text-left">                
                    <div class="flex flex-col sm:flex-row gap-4 items-center sm:items-baseline">
                        <div class="flex flex-wrap flex-col justify-center sm:justify-start gap-x-4">
                            <a href="#" class="hover:text-white transition">Home</a>
                            <!-- <span>|</span> -->
                            <a href="#" class="hover:text-white transition">About Us</a>
                            <!-- <span>|</span> -->
                            <a href="#" class="hover:text-white transition">Events</a>
                            <!-- <span>|</span> -->
                            <a href="#" class="hover:text-white transition">Team</a>
                            <!-- <span>|</span> -->
                            <a href="#" class="hover:text-white transition">Sponsors</a>
                            <!-- <span>|</span> -->
                            <a href="#" class="hover:text-white transition">Gallery</a>
                            <!-- <span>|</span> -->
                            <a href="#" class="hover:text-white transition">Website team</a>
                            <!-- <span>|</span> -->
                            <a href="#" class="hover:text-white transition">Contact</a>
                        </div>
                    </div>

                    <!-- <div class="flex flex-col items-center lg:items-start mx-auto lg:mx-0">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3721.265693648954!2d77.18548217481009!3d11.115208889054932!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3ba8fe2c69d63821%3A0x62e85c894595e774!2sJansons%20Institute%20of%20Technology%20(AUTONOMOUS)!5e1!3m2!1sen!2sin!4v1755262383199!5m2!1sen!2sin" 
                            class="w-full max-w-[350px] h-[300px]" 
                            style="border:0; border-radius: 10px;" 
                            allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                    </div> -->
                </div>

                <div id="socials" class="flex flex-col items-center lg:items-end gap-4">

                    <div class="flex gap-4">
                        <!-- Facebook -->
                        <a href="#" class="p-2 rounded-full bg-white/10 hover:bg-blue-600 transition-all duration-300 hover:scale-110">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 16 16">
                                <path d="M8 0C3.582 0 0 3.582 0 8c0 3.991 2.925 7.31 6.75 7.931V10.39H4.72V8h2.03V6.275c0-2.007 1.194-3.112 3.021-3.112.875 0 1.791.157 1.791.157v1.973h-1.01c-.997 0-1.31.622-1.31 1.259V8h2.23l-.356 2.39H9.25v5.541C13.075 15.31 16 11.991 16 8c0-4.418-3.582-8-8-8z"/>
                            </svg>
                        </a>
                        <!-- Twitter -->
                        <a href="#" class="p-2 rounded-full bg-white/10 hover:bg-sky-500 transition-all duration-300 hover:scale-110">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 16 16">
                                <path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.009-.422A6.685 6.685 0 0 0 16 3.542a6.657 6.657 0 0 1-1.889.518A3.293 3.293 0 0 0 15.555 2a6.57 6.57 0 0 1-2.084.797A3.283 3.283 0 0 0 7.875 5.03a9.325 9.325 0 0 1-6.767-3.431 3.289 3.289 0 0 0 1.018 4.381A3.323 3.323 0 0 1 .64 5.85v.041a3.288 3.288 0 0 0 2.632 3.218A3.203 3.203 0 0 1 2 9.065c0 .013 0 .026.001.04a3.288 3.288 0 0 0 3.067 2.28A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.345 9.345 0 0 0 5.026 15z"/>
                            </svg>
                        </a>
                        <!-- Instagram -->
                        <a href="#" class="p-2 rounded-full bg-white/10 hover:bg-pink-500 transition-all duration-300 hover:scale-110">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 16 16">
                                <path d="M8 0C5.8 0 5.555.01 4.703.048c-.85.04-1.43.178-1.937.38-.53.21-.98.49-1.426.936-.446.446-.726.896-.936 1.426-.202.507-.34 1.087-.38 1.937C.01 5.555 0 5.8 0 8s.01 2.445.048 3.297c.04.85.178 1.43.38 1.937.21.53.49.98.936 1.426.446.446.896.726 1.426.936.507.202 1.087.34 1.937.38C5.555 15.99 5.8 16 8 16s2.445-.01 3.297-.048c.85-.04 1.43-.178 1.937-.38.53-.21.98-.49 1.426-.936.446-.446.726-.896.936-1.426.202-.507.34-1.087.38-1.937C15.99 10.445 16 10.2 16 8s-.01-2.445-.048-3.297c-.04-.85-.178-1.43-.38-1.937-.21-.53-.49-.98-.936-1.426-.446-.446-.896-.726-1.426-.936-.507-.202-1.087-.34-1.937-.38C10.445.01 10.2 0 8 0zm0 3.893A4.107 4.107 0 1 1 3.893 8 4.107 4.107 0 0 1 8 3.893zm4.406-.845a.96.96 0 1 1-1.92 0 .96.96 0 0 1 1.92 0zM8 5.216A2.784 2.784 0 1 0 10.784 8 2.784 2.784 0 0 0 8 5.216z"/>
                            </svg>
                        </a>
                    </div>
                </div>

            </div>


            <div class="pt-12 flex flex-col sm:flex-row items-center justify-center gap-4">
                <p class="text-xs" style="color: rgb(255, 205, 138);"><b>© 2025 Varnave. All rights reserved.</b></p>
                <!-- <div class="flex items-center gap-6 text-xs text-white">
                    <a href="#" class="hover:text-white transition">Terms</a>
                    <a href="#" class="hover:text-white transition">Privacy</a>
                    <a href="#" class="hover:text-white transition">Code of Conduct</a>
                </div> -->
            </div>
        </div>
    </footer>
    
    <a href="#" id="backToTop" aria-label="Back to top"
        class="back-to-top fixed bottom-5 right-5 w-10 h-10 rounded-full bg-emerald-600 text-white flex items-center justify-center shadow-lg opacity-0 pointer-events-none">
        <ion-icon name="arrow-up-outline" class="text-xl"></ion-icon>
    </a>

    <script>
        let allFetchedEvents = []; 

        function showModal(eventId) {
            const event = allFetchedEvents.find(e => e._id === eventId);
            if (!event) return;

            document.getElementById('modalTitle').textContent = event.title;
            document.getElementById('modalDateTime').textContent = `${event.date} • ${event.time}`;
            document.getElementById('modalVenue').textContent = event.venue;
            document.getElementById('modalPrize').textContent = event.prize;
            document.getElementById('modalParticipants').textContent = event.participants;
            document.getElementById('modalFullDesc').textContent = event.fullDescription;
            
            const rulesList = document.getElementById('modalRules');
            rulesList.innerHTML = ''; 
            if (event.rules && event.rules.length > 0) {
                event.rules.forEach(rule => {
                    const li = document.createElement('li');
                    li.textContent = rule;
                    rulesList.appendChild(li);
                });
            } else {
                rulesList.innerHTML = '<li>No specific rules provided.</li>';
            }

                const modal = document.getElementById('eventModal');
                modal.classList.add('is-open');
                // Prevent background scroll while keeping layout stable
                document.body.classList.add('overflow-hidden');
        }

        function hideModal() {
                const modal = document.getElementById('eventModal');
                modal.classList.remove('is-open');
                // Allow background scroll after the hide transition
                setTimeout(() => document.body.classList.remove('overflow-hidden'), 220);
        }

        async function fetchAndRenderEvents() {
            const onStageContainer = document.getElementById('onStageMembers');
            const offStageContainer = document.getElementById('offStageMembers');
            const allMembersContainer = document.getElementById('allMembers');

            // Show loading skeletons
            const loadingSkeleton = `
                <div class="loading-skeleton rounded-xl h-80 animate-pulse bg-gradient-to-b from-green-200 to-blue-200"></div>
                <div class="loading-skeleton rounded-xl h-80 animate-pulse bg-gradient-to-b from-green-200 to-blue-200"></div>
                <div class="loading-skeleton rounded-xl h-80 animate-pulse bg-gradient-to-b from-green-200 to-blue-200"></div>
                <div class="loading-skeleton rounded-xl h-80 animate-pulse bg-gradient-to-b from-green-200 to-blue-200"></div>
            `;
            
            onStageContainer.innerHTML = loadingSkeleton;
            offStageContainer.innerHTML = loadingSkeleton;
            allMembersContainer.innerHTML = loadingSkeleton;

            try {
                const response = await fetch('https://cultural-backend-7gfl.onrender.com/api/events');
                if (!response.ok) throw new Error('Network response was not ok');
                const obj = await response.json();
                
                allFetchedEvents = obj.data; 

                onStageContainer.innerHTML = '';
                offStageContainer.innerHTML = '';
                allMembersContainer.innerHTML = '';

                if (!allFetchedEvents || allFetchedEvents.length === 0) {
                    allMembersContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">No events yet. Stay tuned!</p>';
                    return;
                }

                for (const e of allFetchedEvents) {
                    const venueLower = e.venue.toLowerCase();
                    const isOnStage = venueLower.includes('stage') || venueLower.includes('reception');
                    const categoryKey = isOnStage ? 'eventplaceholder1' : 'eventplaceholder2';
                    
                    const card = `
                        <div class="member-item" data-category="${categoryKey}">
                            <div class="member-card group rounded-xl border border-emerald-100 bg-white shadow hover:shadow-lg transition overflow-hidden flex flex-col h-full">
                                <div class="h-40 w-full overflow-hidden">
                                    <img class="w-full h-full object-cover" src="${e.posterImage}" alt="${e.title}" loading="lazy">
                                </div>
                                <div class="p-4 flex flex-col flex-grow">
                                    <h4 class="text-lg font-semibold text-gray-900">${e.title}</h4>
                                    <p class="mt-1 text-emerald-700 flex items-center gap-2 text-sm">
                                        <ion-icon name="calendar-outline"></ion-icon>
                                        <span>${e.date} • ${e.time}</span>
                                    </p>
                                    <p class="mt-1 text-gray-700 flex items-center gap-2 text-sm">
                                        <ion-icon name="location-outline"></ion-icon>
                                        <span>${e.venue}</span>
                                    </p>
                                    <p class="mt-3 text-sm text-gray-600">${e.description || ''}</p>
                                    <div class="mt-auto pt-4">
                                        <button onclick="showModal('${e._id}')" aria-label="Details for ${e.title}" class="inline-flex items-center gap-2 text-emerald-700 hover:text-emerald-900 font-medium transition-all duration-300 hover:gap-3">
                                            <span>Details</span>
                                            <ion-icon name="open-outline"></ion-icon>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;

                    if (categoryKey === 'eventplaceholder1') {
                        onStageContainer.innerHTML += card;
                    } else {
                        offStageContainer.innerHTML += card;
                    }
                    allMembersContainer.innerHTML += card;
                }

                // Trigger animation for newly added cards
                setTimeout(() => {
                    document.querySelectorAll('.member-card').forEach(card => {
                        card.style.animationPlayState = 'running';
                    });
                }, 100);

            } catch (error) {
                console.error('Failed to fetch events:', error);
                allMembersContainer.innerHTML = '<p class="text-center text-red-500 col-span-full">Failed to load events. Please try again later.</p>';
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            fetchAndRenderEvents();

            const backToTopButton = document.getElementById('backToTop');
            const allBtn = document.getElementById('alleventbut');
            const onBtn  = document.getElementById('onstagebut');
            const offBtn = document.getElementById('offstagebut');
            const allSection = document.getElementById('allevents');
            const onSection  = document.getElementById('eventplaceholder1');
            const offSection = document.getElementById('eventplaceholder2');
            
            function setActive(btn) { 
                [allBtn, onBtn, offBtn].forEach(b => {
                    b.classList.remove('bg-emerald-500', 'text-white', 'active');
                    b.classList.add('bg-emerald-50', 'text-emerald-800');
                }); 
                btn.classList.add('bg-emerald-500', 'text-white', 'active');
                btn.classList.remove('bg-emerald-50', 'text-emerald-800');
            }

            function showOnly(section) {
                [allSection, onSection, offSection].forEach(s => {
                    if (s === section) { s.classList.remove('hiding'); s.classList.add('show'); }
                    else { s.classList.add('hiding'); s.classList.remove('show'); }
                });
            }

            // Default state
            setActive(allBtn);
            showOnly(allSection);

            // Event Listeners
            allBtn.addEventListener('click', (e) => { e.preventDefault(); setActive(allBtn); showOnly(allSection); });
            onBtn.addEventListener('click',  (e) => { e.preventDefault(); setActive(onBtn);  showOnly(onSection); });
            offBtn.addEventListener('click', (e) => { e.preventDefault(); setActive(offBtn); showOnly(offSection); });
            
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) backToTopButton.classList.add('visible');
                else backToTopButton.classList.remove('visible');
            });

            backToTopButton.addEventListener('click', function(e) {
                e.preventDefault();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            // Close modal on escape key press
            window.onkeydown = function( event ) {
                if ( event.key === 'Escape' ) {
                    hideModal();
                }
            };
        });
        const menuToggle = document.getElementById('menu-toggle');
        const menuOverlay = document.getElementById('menu-overlay');

        menuToggle.addEventListener('click', () => {
            menuToggle.classList.toggle('is-active');
            menuOverlay.classList.toggle('is-open');

            if (menuOverlay.classList.contains('is-open')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = 'auto';
            }
        });
    </script>

</body>
</html>